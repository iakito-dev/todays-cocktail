# Today's Cocktail 🍸

> 「カクテルをもっと身近に」— 初心者でも自信を持って選べるカクテルレシピ検索サービス

## はじめに

このプロジェクトは、私自身が海外のバーで体験した「カクテル選びの難しさ」を解決したいという思いから生まれました。

---

## サービス概要

Today's Cocktail は、「カクテルをもっと身近に」という思いから生まれたカクテルレシピ検索サービスです。
ベース種類・材料・人気順など複数の軸でレシピ検索ができ、気に入った一杯はお気に入りとして保存できます。
視覚的にわかりやすい画像と直感的な UI により、初心者でも安心して新しいカクテルに出会える体験を提供します。

<img alt="ogp_img" src="https://github.com/user-attachments/assets/f07884a7-66ee-484b-a2d6-d77410a86c90" />

### サービスURL

**https://todayscocktails.com**

### ゲストユーザーアカウント

- **Email**: `guestuser@example.com`
- **Password**: `password123`

---

## サービス開発の背景

### きっかけとなった体験

海外のバーでドリンクを選ぶとき、名前だけでは味や見た目が想像できないカクテルがずらっと並び、注文に苦戦したことがアプリ開発のきっかけです。

日本ではハイボールやレモンサワーが定番ですが、海外ではそういったメニューはほとんど存在せず、さらにメニューに写真が載っていないことも多いため、よく分からない名前だけを頼りに適当に注文してしまうことがよくありました。

「困ったときはワインやビールを頼めば済む」という選択肢もありますが、せっかくなら幅広い種類のカクテルにも詳しくなり、自分でも**自信を持ってバーで注文できるようになりたい**と感じました。

### 解決したい課題

- **初心者がカクテルを選びにくい**：名前だけでは味や見た目が想像できない
- **情報が散在している**：レシピサイト、SNS、バーのメニューなど、情報がバラバラ
- **初心者向けの情報が少ない**：アルコール度数や材料の説明が不足している

### 目指す価値

本アプリでは、このような開発者自身の体験をもとに、初心者でも直感的に雰囲気が分かる画像や、カクテルの起源・由来・アルコール度数などの情報を分かりやすく整理し、**安心して新しい一杯を選べる**ことを目指しています。

---

## 主な実装機能

- **カクテル一覧表示**：ベース種類・材料・人気順など複数の軸で検索・フィルタリング
- **カクテル詳細ページ**：名前、説明文、画像、材料、レシピなどの詳細情報を表示
- **日替わりレコメンド機能**：「今日の一杯」を日替わりで提示
- **お気に入り機能**：気に入ったカクテルを保存・管理（ログインユーザー限定）
- **ユーザー認証機能**：ユーザー登録・ログイン・パスワードリセット
- **管理者機能**：カクテル情報の作成・編集（管理者ユーザー限定）

---

## 使用技術一覧（Tech Stack）

| カテゴリ               | 採用技術                                                                                                                        |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| フロントエンド         | React 19 / TypeScript / Vite 7 / React Router 7 / Tailwind CSS 3 / shadcn/ui（Radix UI）                                        |
| バックエンド API       | Ruby 3.4.6 / Rails 8.0.3（API モード）                                                                                          |
| データベース           | Supabase CLI / Cloud（PostgreSQL 17）                                                                                           |
| 認証                   | Devise / devise-jwt                                                                                                             |
| 外部API連携            | OpenAI API（生成・翻訳） / TheCocktailDB API（カクテル情報） / Unsplash API（画像） / Resend API（メール送信）                  |
| インフラ・ホスティング | Vercel（フロントエンド） / Render（バックエンド API） / Cloudflare DNS                                                          |
| CI/CD                  | GitHub Actions（lint / test） / Vercel & Render Deploy Hooks                                                                    |
| テスト                 | Vitest 4（フロント） / RSpec（Rails API）                                                                                       |
| UI/UX デザイン         | Figma / Figma Make                                                                                                              |
| 開発支援・コード整形   | ESLint 9 / Prettier 3 / Husky 9 / lint-staged 16 / RuboCop                                                                      |
| 開発環境               | Git / Docker / Docker Compose / VS Code / GitHub Copilot / Codex（Sonnet 4.5 / gpt-5 / gpt-5-codex） / Colima（軽量Docker環境） |

---

## インフラ構成図

ユーザーからのリクエストがCloudflare DNSを経由してVercel（フロントエンド）とRender（バックエンド）に到達し、SupabaseのPostgreSQLデータベースに接続する構成を示しています。また、GitHub ActionsによるCI/CDパイプラインと、OpenAI、Unsplash、Resend、TheCocktailDBなどの外部API連携も含まれています。

```mermaid
flowchart LR
  user["ユーザー"]
  dns["Cloudflare DNS"]
  fe["Vercel (React SPA)"]
  api["Render (Rails API)"]
  db["Supabase Cloud PostgreSQL"]
  cache["RAILS.cache"]

  user -->|HTTPS| dns
  dns --> fe
  dns --> api
  api --> db
  api --> cache
```

**主要コンポーネント:**

- **フロントエンド**: Vercel上でホスティングされたReact SPA
- **バックエンド**: Render上でホスティングされたRails API
- **データベース**: Supabase CloudのPostgreSQL 17
- **キャッシュ**: Rails.cache（メモリキャッシュ）
- **DNS**: Cloudflare DNS
- **CI/CD**: GitHub Actionsによる自動デプロイ
- **外部API**: OpenAI（AI生成）、Unsplash（画像）、Resend（メール）、TheCocktailDB（カクテル情報）

---

## ER 図

データベースのテーブル構造とリレーションシップを示しています。

```mermaid
erDiagram
  USERS ||--o{ FAVORITES : "お気に入り"
  COCKTAILS ||--o{ FAVORITES : "お気に入り"
  COCKTAILS ||--o{ COCKTAIL_INGREDIENTS : "材料構成"
  INGREDIENTS ||--o{ COCKTAIL_INGREDIENTS : "使用材料"
  USERS ||--o{ JWT_DENYLISTS : "無効化トークン"
```

**主要テーブル:**

- **USERS**: ユーザー情報
- **COCKTAILS**: カクテル情報
- **INGREDIENTS**: 材料情報
- **FAVORITES**: お気に入り（ユーザーとカクテルの多対多）
- **COCKTAIL_INGREDIENTS**: カクテルと材料の関連（多対多）
- **JWT_DENYLISTS**: JWTトークンの無効化リスト

テーブル定義の詳細は `docs/db_design.md` に記載。

---

## 画面遷移図

アプリケーションの画面遷移とユーザーフローを示しています。

```mermaid
flowchart TD
  Home[トップ / 検索] --> Detail[カクテル詳細]
  Home --> Favorites[お気に入り一覧]
  Home --> Login[ログイン]
  Login --> Signup[サインアップ]
  Detail --> Favorites
  Home --> TodaysPick[今日の一杯]
```

**主要画面:**

- **トップ / 検索**: カクテル一覧と検索機能
- **カクテル詳細**: 個別カクテルの詳細情報
- **お気に入り一覧**: 保存したカクテルの一覧（ログイン必須）
- **ログイン / サインアップ**: ユーザー認証
- **今日の一杯**: 日替わりレコメンド機能

---

## 技術選定理由

- **Rails 8 (API モード)**
  他のバックエンドフレームワークと比較して日本語の学習教材や導入事例が豊富である点が採用理由です。本プロジェクトはポートフォリオとしての活用も想定していたため、スタートアップ企業や未経験・ジュニア層での採用実績が比較的多い Ruby を選択しました。

- **React + Vite + TypeScript**
  もともと JavaScript を学習していたことに加え、日本語の教材や採用実績が豊富で、現在主流のフロントエンド開発手法に合致している点から採用しました。Next.js も検討しましたが、Ruby と併用する場合は学習範囲が広がり負荷が増える可能性があること、また本プロジェクトでは複雑な要件が特にないため、よりシンプルに扱える React を選択しました。

- **Render / Vercel / Cloudflare**
  当初は前職で使用経験のある AWS も検討しましたが、フロントとバックエンドでそれぞれ ECS Fargate を運用し、RDS を配置する構成では、最小スペックでも月額 6,000〜10,000 円ほどのコストが発生する見込みでした。個人開発として長く運用したいことから、低コストかつ小〜中規模アプリ向けの機能が充実している Render・Vercel・Cloudflare を組み合わせる構成を選択しました。

- **Supabase Cloud**
  同様にコスト面を考慮し、無料で簡単に PostgreSQL 環境をデプロイできる点を評価しました。前職では MySQL の利用経験が中心でしたが、Supabase が PostgreSQL に特化していること、そして今後さらにシェアが伸びると見込まれる PostgreSQL を学習する良い機会になると考え採用しました。

---

## 工夫した点

### AI を使った材料・レシピ文のコンテンツ生成

**課題**

当初は海外のオープンソースカクテルデータを英語で取得し、DeepL で日本語に翻訳して利用しようとしていました。しかし、海外と日本では材料の種類や量の単位が異なり、単に翻訳しただけでは「日本では使いづらいレシピ」になるケースが多くありました。

**解決策**

一度日本向けの材料や分量に整理し直した上で、その情報を OpenAI API（GPT-5）に渡して説明文・レシピ文を生成し、自分で最終チェック・微修正するフローに変更しました。

**工夫した点**

- プロンプト設計を工夫し、翻訳ルールを明確に定義して一貫性のある結果を得る
- バッチ処理で複数材料を一度に翻訳し、API呼び出し回数を削減
- エラーハンドリングを実装し、API呼び出しが失敗しても処理を継続できるように

**結果**

日本のユーザーが実際に作りやすい内容にしつつ、カクテルの雰囲気も伝わる文章を効率よく用意できるようになりました。手動で翻訳・校正する時間を大幅に削減できました。

### AI開発支援ツールの積極的な活用

**取り組み**

このプロジェクトでは、GitHub Copilot、Codex（Sonnet 4.5 / gpt-5 / gpt-5-codex）、Cursor、Figma Make など、今後主流になっていくであろうAI技術を積極的に活用しました。

**工夫した点**

- **GitHub Copilot / Codex / Cursor**: コード生成やリファクタリングの提案を受けながら、自分でも理解して使い分けられるように意識して使用
- **Figma Make**: UIデザインの自動生成やプロトタイプ作成を効率化
- AIの提案をそのまま採用するのではなく、必ず自分で理解し、必要に応じて修正・改善する姿勢を徹底

**学び**

開発未経験である自分でもAIの力を借りてここまでのアプリを作成できることは驚きでした。一方で、AIが高速で生成する情報を都度理解しようとすると意外と大変でした。

AIにすべて任せるのではなく、知らないトピックやコードが出てきたら都度AIに質問を投げかけて理解しようと意識することが今の開発においては重要だと感じました。この姿勢を徹底することで、今後もエンジニアとして爆速的に成長できるかもしれないと実感しています。

### カクテル一覧・詳細・検索機能のパフォーマンス改善

**課題**

最初の実装では、検索条件を変更するたびにほぼ全件のデータを取得してしまい、「動くけれど重い」という状態でした。とくに一覧ページでのスクロール時に引っかかりが発生していました。

**取り組んだ改善**

- 検索条件ごとにクエリを最適化し、本当に必要なデータだけを取得するように改善
- Rails.cache を活用した12時間キャッシュでDB負荷を削減
- コンポーネントの責務を整理し、関係のないコンポーネントが再レンダリングされないように見直し
- 画像には遅延ロードを採用し、まずはテキストだけでも素早く表示できるように改善
- N+1問題の回避：`includes`や`left_joins`で関連データを事前読み込み

**結果**

検索条件を切り替えても画面がもたつきにくくなり、「一覧から気になるカクテルをサクサク眺められる」体験に近づけられました。特に、キャッシュの導入により、同じ検索条件での2回目以降のアクセスが大幅に高速化されました。

---

## 苦労した点

### Devise / JWT を用いた認証機能の実装

**課題**

AI に相談しながら進めていたものの、認証周りの知識が浅く、「どこまでAIの提案を採用すべきか」「どれくらい自分で設計を詰めるべきか」で悩む場面が多くありました。

**特に苦労した点**

- **トークンの保存場所**：localStorage vs sessionStorage vs Cookie の選択
- **有効期限切れ時の扱い**：フロントエンドとバックエンドの両方で適切にハンドリングする方法
- **ログアウト時のトークン無効化**：JWT はステートレスなため、無効化リスト（denylist）を実装する必要があった

**解決プロセス**

AI の案を参考にしつつ手を動かして検証し、公式ドキュメントを読みながら理解を深めました。特に、`devise-jwt` の仕組みを理解するために、JWT の構造や署名・検証の流れを実際にコードを書いて確認しました。

**学び**

その過程で、「とりあえず動いているだけのコード」から、自分の言葉で認証の仕組みを説明できるレベルまで落とし込み、認証フローを組み立てられるようになってきたと実感しています。セキュリティの重要性も改めて実感しました。

### Lint・自動テストなど開発環境の整備と運用

**課題**

ESLint / Prettier / Vitest / RSpec などの導入では、設定やバージョン相性によるエラーや「ローカルでは通るのに CI では落ちる」といったトラブルが複数発生しました。

**具体的な問題**

- ESLint 9 と Prettier 3 の設定の競合
- Vitest と Vite のバージョン相性問題
- GitHub Actions での Node.js バージョンとローカルの不一致
- RSpec のテスト環境と本番環境の違いによるエラー

**解決プロセス**

Husky や lint-staged を用いて「コミット前のチェック」を徹底し、GitHub Actions で lint / test を自動実行する仕組みを整え、1つずつ問題を解決していきました。特に、CI 環境をローカル環境と一致させることで、多くの問題を解決できました。

**学び**

時間はかかりましたが、今では新機能追加やリファクタリングの際も安心してコードを触ることができ、「作って終わり」ではなく継続的に育てやすいコードベースに近づけられたと感じています。開発環境の整備の重要性を実感しました。

---

## このプロジェクトで学んだこと

### 技術的な学び

- **フロントエンドとバックエンドの分離設計**：SPA + API の構成で、それぞれの責務を明確に分離することの重要性
- **認証・セキュリティの実装**：JWT 認証の仕組みや、トークンの無効化方法など、セキュリティを意識した実装の重要性
- **パフォーマンス最適化**：キャッシュ戦略、N+1問題の回避など、実際のユーザー体験を向上させる技術
- **テストの重要性**：RSpec と Vitest を使ったテストの書き方や、CI/CD での自動テスト実行の重要性
- **開発環境の整備**：ESLint、Prettier、Husky などを使った開発環境の整備が、コード品質の向上に直結すること

### プロセス面での学び

- **要件定義の重要性**：最初に「ユーザーに何をしてほしいか」を明確にすることで、開発の方向性が定まること
- **プロトタイプの価値**：Figma でプロトタイプを作成することで、実装前にUI/UXの問題に気づけること
- **段階的な実装**：最初から完璧を目指すのではなく、動くものを作ってから改善していくアプローチの重要性
- **ドキュメント化**：技術的な判断や設計の意図をドキュメントに残すことで、後から見返したときに理解しやすくなること

---

## 開発期間

**アイデア出し・企画** → **必要な機能の洗い出し** → **画面設計・テーブル設計** → **実装** → **テスト・デバッグ** → **デプロイ** という流れで作成しました。

MVPリリースまではAIを最大限活用し、**1〜2ヶ月で完了**しました。

---

## 今後の開発ロードマップ

- カクテル画像アップロード機能の実装（現在は外部URLのみ取得）
- 「定番」「簡単」などのタグ付け機能の追加、およびフィルタリング項目への反映
- ソーシャルログイン機能（LINE / Google など）の導入
- コメント投稿機能の追加
- カクテルレシピの拡充
- プレミアムユーザー向け機能（課金）の導入

---

## 開発者

**伊藤 彬人（Akito Ito / iakito-dev）**

- **GitHub**: [https://github.com/iakito-dev](https://github.com/iakito-dev)
- **ポートフォリオ**: [https://iakito-dev.github.io/Resume_JP/](https://iakito-dev.github.io/Resume_JP/)
- **サービスURL**: [https://todayscocktails.com](https://todayscocktails.com)
